<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://ogobrecht.com name=base><title>
Ottmar’s Notes • Pitfalls with Oracle 11g XE and Docker on Mac OS</title><link href=https://ogobrecht.com/img/avatar.png rel=icon type=image/png><link title="Ottmar’s Notes - Atom Feed" href=https://ogobrecht.com/atom.xml rel=alternate type=application/atom+xml><link href="https://ogobrecht.com/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://ogobrecht.com/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="The swap space problem and how to fix it" name=description><meta content="The swap space problem and how to fix it" property=og:description><meta content="Pitfalls with Oracle 11g XE and Docker on Mac OS" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://ogobrecht.com/blog/pitfalls-with-oracle-11g-xe-and-docker-on-mac-os/ property=og:url><meta content="Ottmar’s Notes" property=og:site_name><noscript><link href=https://ogobrecht.com/no_js.css rel=stylesheet></noscript><script src=https://ogobrecht.com/js/initializeTheme.min.js></script><script defer src=https://ogobrecht.com/js/themeSwitcher.min.js></script><script src="https://ogobrecht.com/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><a href=#main-content id=skip-link>Skip to content</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://ogobrecht.com/>Ottmar’s Notes</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">Pitfalls with Oracle 11g XE and Docker on Mac OS</h1><a class="u-url u-uid" href=https://ogobrecht.com/blog/pitfalls-with-oracle-11g-xe-and-docker-on-mac-os/></a><ul class=meta><span class="hidden p-author h-card"> <a title="Ottmar Gobrecht" class=u-url href=https://ogobrecht.com rel=author>Ottmar Gobrecht</a> </span><li><time class=dt-published datetime=2017-03-21>21st Mar 2017</time><li title="574 words"><span aria-hidden=true class=separator>•</span>3 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a class=p-category href=https://ogobrecht.com/tags/docker/>docker</a>, <li class=tag><a class=p-category href=https://ogobrecht.com/tags/oracle/>Oracle</a>, <li class=tag><a class=p-category href=https://ogobrecht.com/tags/mac/>Mac</a></ul><p class=p-summary hidden>The swap space problem and how to fix it<section class="e-content body"><p>Recently I tried to install Oracle XE into a docker container on Mac OS Sierra using the <a class=external href=https://github.com/oracle/docker-images/blob/master/OracleDatabase/dockerfiles/11.2.0.2/Dockerfile.xe rel=external>official docker file</a> from Oracle. I had no luck, because the installation failed with this error message:<blockquote><p>This system does not meet the minimum requirements for swap space. Based on the amount of physical memory available on the system, Oracle Database 11g Express Edition requires 2048 MB of swap space. This system has 0 MB of swap space. Configure more swap space on the system and retry the installation.</blockquote><p>The problem is, that you can’t do anything for this on a Mac - the system manages the swap files by itself and if you need for an example 64 GB you will get it. My new standard MacBook has 8 GB RAM and there is currently no reason for a swap file.<p>So, what can we do? After a short search I found <a class=external href=https://www.elastichosts.com/blog/oracle-database-installation-on-a-container-running-centos/ rel=external>this blog post</a>, which describes how to alter the pre-installation script of the RPM installation file with the help of the <code>repmrebuild</code> command. Unfortunately this command is not available on Mac OS. I found only rpmbuild as part of the rpm installation with <a class=external href=https://brew.sh rel=external>Homebrew</a>.<p>Luckily I found another way to modify a rpm package under Mac OS: There is a Ruby based tool to build packages for multiple platforms called <a class=external href=https://github.com/jordansissel/fpm rel=external>fpm</a>. So, lets start:<p>If you don’t have <a class=external href=https://brew.sh rel=external>Homebrew</a> on your Mac, install this first:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">/usr/bin/ruby</span><span class=z-string> -e</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-string">"</span><span class=z-punctuation>$(</span><span class="z-entity z-name z-function">curl</span><span class=z-string> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install</span><span class=z-punctuation>)</span><span class="z-punctuation z-definition z-string">"</span></span></code></pre><p>Install rpm:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">brew</span><span class=z-string> install rpm</span></span></code></pre><p>Install tar:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">brew</span><span class=z-string> install gnu-tar</span></span></code></pre><p>Install fpm:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">gem</span><span class=z-string> install --no-ri --no-rdoc fpm</span></span></code></pre><p>Unzip the downloaded Linux XE installation archive and go into the directory Disk1:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">unzip</span><span class=z-string> oracle-xe-11.2.0-1.0.x86_64.rpm.zip</span><span class=z-punctuation> &&</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">cd</span><span class=z-string> Disk1</span></span></code></pre><p>Write rpm scripts to text file:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">rpm</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  --scripts</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  -qp oracle-xe-11.2.0-1.0.x86_64.rpm</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class="z-keyword z-operator">  ></span><span class=z-string> scripts.txt</span></span></code></pre><p>Find this loop (from line 197 until line 212 as of this writing) and comment out or delete it:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-punctuation z-definition z-comment z-comment"># check and disallow install, if swap space is less than Min( 2047, 2 * RAM)`</span></span>
<span class=giallo-l><span class=z-keyword>if</span><span class=z-punctuation> [</span><span class="z-punctuation z-definition z-variable z-source"> $swapspace</span><span class="z-keyword z-operator"> -lt</span><span class="z-punctuation z-definition z-variable z-source"> $requiredswapspace</span><span class=z-punctuation> ]</span></span>
<span class=giallo-l><span class=z-keyword>then</span></span>
<span class=giallo-l><span class=z-keyword>	if</span><span class=z-punctuation> [</span><span class="z-punctuation z-definition z-string"> "</span><span class="z-variable z-other z-normal z-shell">$requiredswapspace</span><span class="z-punctuation z-definition z-string">"</span><span class="z-keyword z-operator"> =</span><span class="z-punctuation z-definition z-string z-string"> "2047"</span><span class=z-punctuation> ];</span></span>
<span class=giallo-l><span class=z-keyword>	then</span></span>
<span class=giallo-l><span class=z-source>		requiredswapspace</span><span class="z-keyword z-operator">=</span><span class=z-string>2048</span></span>
<span class=giallo-l><span class=z-keyword>	fi</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">	echo</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">        echo</span><span class="z-punctuation z-definition z-string z-string"> "This system does not meet the minimum requirements for swap space.  Based on</span></span>
<span class=giallo-l><span class=z-string>the amount of physical memory available on the system, Oracle Database 11g</span></span>
<span class=giallo-l><span class=z-string>Express Edition requires </span><span class="z-variable z-other z-normal z-shell">$requiredswapspace</span><span class=z-string> MB of swap space. This system has </span><span class="z-variable z-other z-normal z-shell">$swapspace</span><span class=z-string> MB</span></span>
<span class=giallo-l><span class=z-string>of swap space.  Configure more swap space on the system and retry the</span></span>
<span class=giallo-l><span class="z-string z-punctuation z-definition z-string">installation."</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">	echo</span></span>
<span class=giallo-l><span class="z-support z-function z-builtin">        exit</span><span class="z-constant z-numeric"> 1</span></span>
<span class=giallo-l><span class=z-keyword>fi</span></span></code></pre><p>Find this line (starting on line 328 as of this writing) and delete the line and everything behind until the file end:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">postinstall</span><span class=z-string> scriptlet</span><span class=z-source> (using</span><span class=z-string> /bin/sh</span><span class=z-source>):</span></span></code></pre><p>Delete the very first line containing this code:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">preinstall</span><span class=z-string> scriptlet</span><span class=z-source> (using</span><span class=z-string> /bin/sh</span><span class=z-source>):</span></span></code></pre><p>Save the file and bring it back into the rpm with this command (will take some time):<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">fpm</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  -s rpm</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  -t rpm</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  -f --before-install scripts.txt</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  ./oracle-xe-11.2.0-1.0.x86_64.rpm</span></span></code></pre><p>Go out of Disk1 and update the zip archive, because the Oracle provided build script needs it compressed (will take some time):<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-support z-function z-builtin">cd</span><span class=z-string> ..</span><span class=z-punctuation> &&</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">zip</span><span class=z-string> -r oracle-xe-11.2.0-1.0.x86_64.rpm.zip Disk1</span></span></code></pre><p>When you now do the Docker build you will face another error message:<blockquote><p>package oracle-xe-11.2.0-1.0.x86_64 is intended for a different operating system</blockquote><p>To fix this is fairly easy. Open the Dockerfile.xe, go to line 61 (as of this writing) and change this code:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">rpm</span><span class=z-string> -i Disk1/</span><span class=z-variable>*</span><span class=z-string>.rpm</span><span class=z-punctuation> &&</span><span class="z-constant z-character z-escape">    \</span></span></code></pre><p>to this one:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">rpm</span><span class=z-string> -i --ignoreos Disk1/</span><span class=z-variable>*</span><span class=z-string>.rpm</span><span class=z-punctuation> &&</span><span class="z-constant z-character z-escape"> \</span></span></code></pre><p>When you now start the docker build you should be successful (will take some time):<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">sudo</span><span class=z-string> ./buildDockerImage.sh -v</span><span class="z-constant z-numeric"> 11.2.0.2</span><span class=z-string> -x -i</span></span></code></pre><p>The last step is to run the container - on the first startup the database is created (will take some time, align the name to your needs):<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">docker</span><span class=z-string> run</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  --name orclapex51</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  --shm-size=1g</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  -p 1521:1521</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  -p 8080:8080</span><span class="z-constant z-character z-escape"> \</span></span>
<span class=giallo-l><span class=z-string>  oracle/database:11.2.0.2-xe</span></span></code></pre><p>If you plan to use APEX without any dedicated webserver (maybe because you are the only user and it is only a small dev instance) you should pimp the EPG a little bit:<pre class="giallo z-code"><code data-lang=sql><span class=giallo-l><span class=z-keyword>alter system set</span><span class=z-source> shared_servers</span><span class="z-keyword z-operator">=</span><span class="z-constant z-numeric">10</span><span class=z-source> scope</span><span class="z-keyword z-operator">=</span><span class=z-keyword>both</span><span class=z-source>;</span></span>
<span class=giallo-l><span class=z-keyword>alter system set</span><span class=z-source> max_shared_servers</span><span class="z-keyword z-operator">=</span><span class="z-constant z-numeric">20</span><span class=z-source> scope</span><span class="z-keyword z-operator">=</span><span class=z-keyword>both</span><span class=z-source>;</span></span>
<span class=giallo-l><span class=z-keyword>alter system set</span><span class=z-source> dispatchers</span><span class="z-keyword z-operator">=</span><span class="z-punctuation z-definition z-string z-string">'(PROTOCOL=TCP) (SERVICE=xeXDB) (DISPATCHERS=2)'</span><span class=z-source> scope</span><span class="z-keyword z-operator">=</span><span class=z-keyword>both</span><span class=z-source>;</span></span></code></pre><p>I use currently a Node.js based proxy server running directly on my Mac OS, because I need a webserver there anyway. The nice thing is, that the EPG don’t need to serve the images and I also don’t need to install the images into the EPG, when I upgrade to a newer APEX version. This saves me time and the EPG runs faster because of less number of requests.<p>Happy installing :-)<p>Ottmar</section><nav class="full-width article-navigation"><div><a aria-describedby=left_title aria-label=Prev href=https://ogobrecht.com/blog/apex-plugin-dhtmlx-gantt/><span class=arrow>←</span> Prev</a><p aria-hidden=true id=left_title>APEX Plugin dhtmlxGantt</div><div><a aria-describedby=right_title aria-label=Next href=https://ogobrecht.com/blog/jquery-plugin-svg2img/>Next <span class=arrow>→</span></a><p aria-hidden=true id=right_title>jQuery Plugin svg2img</div></nav></article></main><div id=button-container><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://ogobrecht.com/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://ogobrecht.com/atom.xml> <img alt=feed loading=lazy src=https://ogobrecht.com/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/ogobrecht> <img alt=GitHub loading=lazy src=https://ogobrecht.com/social_icons/github.svg title=GitHub> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://bsky.app/profile/ogobrecht.com> <img alt=Bluesky loading=lazy src=https://ogobrecht.com/social_icons/bluesky.svg title=Bluesky> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://www.linkedin.com/in/ogobrecht/> <img alt=LinkedIn loading=lazy src=https://ogobrecht.com/social_icons/linkedin.svg title=LinkedIn> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=mailto:ottmar.gobrecht@gmail.com> <img alt=Email loading=lazy src=https://ogobrecht.com/social_icons/email.svg title=Email> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/imprint/> imprint </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/privacy/> privacy policy </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>