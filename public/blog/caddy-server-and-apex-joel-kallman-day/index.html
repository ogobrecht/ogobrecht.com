<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com giscus.app;connect-src 'self';script-src 'self'  giscus.app 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://ogobrecht.com name=base><title>
Ottmar’s Notes • Caddy Server - APEX behind a fully automated SSL proxy #JoelKallmanDay</title><link href=https://ogobrecht.com/img/avatar.png rel=icon type=image/png><link title="Ottmar’s Notes - Atom Feed" href=https://ogobrecht.com/atom.xml rel=alternate type=application/atom+xml><link href="https://ogobrecht.com/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://ogobrecht.com/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Forget self-signed certificates and browsers that complain about them" name=description><meta content="Forget self-signed certificates and browsers that complain about them" property=og:description><meta content="Caddy Server - APEX behind a fully automated SSL proxy #JoelKallmanDay" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/ property=og:url><meta content="Ottmar’s Notes" property=og:site_name><noscript><link href=https://ogobrecht.com/no_js.css rel=stylesheet></noscript><script src=https://ogobrecht.com/js/initializeTheme.min.js></script><script defer src=https://ogobrecht.com/js/themeSwitcher.min.js></script><script src="https://ogobrecht.com/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><a href=#main-content id=skip-link>Skip to content</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://ogobrecht.com/>Ottmar’s Notes</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">Caddy Server - APEX behind a fully automated SSL proxy #JoelKallmanDay</h1><a class="u-url u-uid" href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/></a><ul class=meta><span class="hidden p-author h-card"> <a title="Ottmar Gobrecht" class=u-url href=https://ogobrecht.com rel=author>Ottmar Gobrecht</a> </span><li><time class=dt-published datetime=2024-10-16>16th Oct 2024</time><li title="1702 words"><span aria-hidden=true class=separator>•</span>9 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a class=p-category href=https://ogobrecht.com/tags/oracle/>Oracle</a>, <li class=tag><a class=p-category href=https://ogobrecht.com/tags/apex/>APEX</a>, <li class=tag><a class=p-category href=https://ogobrecht.com/tags/ssl/>SSL</a>, <li class=tag><a class=p-category href=https://ogobrecht.com/tags/proxy/>proxy</a>, <li class=tag><a class=p-category href=https://ogobrecht.com/tags/caddy/>Caddy</a></ul><p class=p-summary hidden>Forget self-signed certificates and browsers that complain about them<section class="e-content body"><p>How time flies. Almost exactly three years ago to the day, I wrote my last blog post. Many thanks to Tim Hall and his reminder to write something again for the <a class=external href=https://oracle-base.com/blog/2024/09/27/joel-kallman-day-2024-announcement/ rel=external>#JoelKallmanDay</a>.<h2 id=introduction>Introduction</h2><p>Have you ever been annoyed by the fact that your browser always shows you in red in the URL in your development environment that you have issued the SSL certificate yourself and that it is therefore invalid for it?<p>That doesn’t have to be the case. In addition to the large web servers such as <a class=external href=https://httpd.apache.org/ rel=external>Apache</a> or <a class=external href=https://nginx.org/en/ rel=external>NGINX</a>, there are many others. One of these is <a class=external href=https://caddyserver.com/ rel=external>Caddy</a>, which occupies a special position in terms of automatic SSL: It comes with an entire SSL certification authority and can automatically integrate its root certificate into the operating system’s certificate store locally on the computer. Your browser will then no longer complain about an invalid certificate.<p>The only challenge with Caddy is that you need to know how to configure it so that APEX runs properly behind it as a reverse proxy. Unfortunately, this is a bit complicated, not because of Caddy, but because of APEX or ORDS. Let’s put it this way: APEX behind a reverse proxy has its pitfalls. At least if you don’t want to work on the standard port 443.<p>If you want to know more about it, you can find a lot of blog posts about it - mostly about Apache or NGINX. However, I wanted to use Caddy’s fully automatic SSL termination, so I had to look at how it can be done with Caddy using the information available. Special thanks go to my colleague Peter Raganitsch, who helped me a lot both personally and with his blog entry on APEX and NGINX, which is already several years old - here is the link: <a class=external href=https://www.oracle-and-apex.com/the-oracle-apex-reverse-proxy-guide-using-NGINX/ rel=external>The Oracle APEX Reverse Proxy Guide using NGINX</a>.<h2 id=installation>Installation</h2><p>Caddy is written in <a class=external href=https://go.dev/ rel=external>Go</a>. The <a href="https://caddyserver.com/download?package=github.com%2Fcaddyserver%2Freplace-response" class=external rel=external>Download</a> only ever includes a single binary file for the respective operating system. Caddy supports plugins to integrate additional functionality into the web server. Manipulating HTTP headers and redirecting URLs is of course basic functionality. Changing the content of the delivered web pages, on the other hand, is a functionality that must be retrofitted using a plugin. Since we need this, we have to initiate a so-called custom build so that the plugin is integrated into the binary file.<p>The download link above has already preselected the plugin. You only have to select the target operating system if it was not recognized correctly. This custom build mode is also the reason why it makes no sense to install Caddy with a package manager such as <a class=external href=https://brew.sh/ rel=external>Homebrew</a> (Mac) or <a class=external href=https://chocolatey.org/ rel=external>Chocolatey</a> (Windows). After downloading, you should add Caddy to the search path of your operating system to make it easier to access.<p>One more note: Caddy attempts to integrate its root certificate into the operating system’s certificate store at startup. However, this requires libraries from the <a class=external href=https://firefox-source-docs.mozilla.org/security/nss/index.html rel=external>Network Security Services (NSS)</a>, a Mozilla project (see also <a class=external href=https://en.wikipedia.org/wiki/Network_Security_Services rel=external>Wikipedia</a>). If Caddy cannot find these libraries, you will have to import the root certificate from Caddy yourself. I installed the libraries on my Mac with Homebrew (brew install nss) and it worked automatically (of course you will be asked for the admin password for this process). For Linux you can use the respective package manager. There is not really an installation option for Windows. Allegedly it should be enough to have Firefox installed, which then probably comes with the required nss3.dll (I have not verified this, I work with Chromium on a Mac).<h2 id=caddy-configuration>Caddy Configuration</h2><p>Now the actual core of the blog post, the configuration. Caddy basically uses a JSON format for its configuration and can also be reconfigured at runtime without restarting via API (another special feature). However, there are a few adapters that can also read other formats when Caddy is started. The best-known format is probably the so-called Caddyfile, which is easier for people to read and write than a highly hierarchical JSON:<pre class="giallo z-code"><code data-lang=plain><span class=giallo-l><span>{</span></span>
<span class=giallo-l><span>    order replace after encode</span></span>
<span class=giallo-l><span>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>localhost:8001 {</span></span>
<span class=giallo-l><span>    handle /ords/* {</span></span>
<span class=giallo-l><span>        reverse_proxy http://localhost:7001 {</span></span>
<span class=giallo-l><span>            header_down Location //localhost/ //localhost:8001/</span></span>
<span class=giallo-l><span>            header_up Host localhost:8001</span></span>
<span class=giallo-l><span>            header_up +HTTP_X-Forwarded-Port 8001</span></span>
<span class=giallo-l><span>            header_up -Origin</span></span>
<span class=giallo-l><span>        }</span></span>
<span class=giallo-l><span>        replace {</span></span>
<span class=giallo-l><span>            //localhost/ //localhost:8001/</span></span>
<span class=giallo-l><span>        }</span></span>
<span class=giallo-l><span>    }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>    handle_path /i/* {</span></span>
<span class=giallo-l><span>        root * ./images</span></span>
<span class=giallo-l><span>        file_server</span></span>
<span class=giallo-l><span>    }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>    redir /ords /ords/</span></span>
<span class=giallo-l><span>    redir / /ords/</span></span>
<span class=giallo-l><span>}</span></span></code></pre><p>The first block is outside a site and global options are defined in it. Here we place the <code>replace</code> plugin in the correct process order so that it works as desired (<code>order replace after encode</code>, see also the <a class=external href=https://github.com/caddyserver/replace-response rel=external>plugin on GitHub</a>).<p>Then comes the configuration for our local development server:<ul><li><code>localhost:8001</code>: If Caddy recognizes a domain (including localhost), a certificate is automatically issued for the domain.<li><code>handle /ords/*</code>: Starts the configuration for the path <code>/ords/*</code>.<li><code>reverse_proxy http://localhost:7001</code>: We want to forward all <code>/ords/*</code> requests to the ORDS on port 7001.</ul><p>Now comes the part where I wrote at the beginning that APEX behind a reverse proxy has its pitfalls. In an ideal world, it would not be necessary to tell Caddy more about the reverse proxy directive, as the usual headers are automatically set by Caddy so that the service behind it knows that the request has gone via a proxy server (X-Forwarded-*, see also the <a class=external href=https://caddyserver.com/docs/caddyfile/directives/reverse_proxy#headers rel=external>documentation on this</a>):<ul><li><code>header_down Location //localhost/ //localhost:8001/</code>: header_down means in the direction of the browser, so we replace all location headers in which the port is missing with the correct information.<li><code>header_up Host localhost:8001</code>: header_up means direction ORDS, so we tell ORDS what the hostname and port is (unfortunately ORDS does not understand correctly and ignores the port information).<li><code>header_up +HTTP_X-Forwarded-Port 8001</code>: Note the small plus symbol. This means we are adding this header. I also tried <code>X-Forwarded-Port 8001</code>, but ORDS seems to ignore it. Fortunately, APEX is smart enough to honor the port information from multiple headers, so at least the URLs generated by APEX are correct.<li><code>header_up -Origin</code>: Here the small minus symbol means that the header should be deleted. We do this so that ORDS does not exit the game with cross origin errors. I actually configured ORDS so that this wouldn’t be necessary, but it didn’t work. If anyone has a better solution, please let me know (see the ORDS configuration below).<li><code>replace</code> and <code>//localhost/ //localhost:8001/</code>: The same game as before, only this time not with the headers, but with the content of the responses (response body) that the ORDS sends back due to REST calls (mostly JSON data). APEX is completely left out here.</ul><p>Now standard functionality again:<ul><li><code>handle_path /i/*</code> (and the following two lines): This is where we host our static APEX files such as JavaScript, CSS, etc., so that this does not have to be taken over by ORDS.<li><code>redir /ords /ords/</code>: Here we redirect requests to the correct path without a trailing slash<li>redir <code>/ /ords/</code>: You should adapt this individually if you want to treat the root directory differently.</ul><p>In defense of the ORDS, however, I have to say that you should work with the standard port 443 in a productive environment. This makes the problems behind a proxy much smaller or even disappear. But none of this helps if you can’t fall back on the standard port. In my case, the port depends on which development branch I am currently in. I could be running several instances in parallel, so not every server can want to work on the same port…<h2 id=ords-configuration>ORDS Configuration</h2><p>Here is my sample configuration for the ORDS (settings.xml):<pre class="giallo z-code"><code data-lang=xml><span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;?</span><span class="z-entity z-name z-tag">xml</span><span class="z-entity z-other z-attribute-name"> version</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"1.0"</span><span class="z-entity z-other z-attribute-name"> encoding</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"UTF-8"</span><span class="z-punctuation z-definition z-tag">?></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag z-keyword z-other z-doctype">&lt;!DOCTYPE</span><span class=z-text> properties SYSTEM "http://java.sun.com/dtd/properties.dtd"</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">properties</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">comment</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>Saved on Wed Oct 09 12:14:37 UTC 2024</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">comment</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"database.api.enabled"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>true</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"debug.printDebugToScreen"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>true</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"security.externalSessionTrustedOrigins"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>localhost:8001</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"security.httpsHeaderCheck"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>X-Forwarded-Proto:https</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"security.requestValidationFunction"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>ords_util.authorize_plsql_gateway</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"http.cookie.filter.byValue"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>startsWith:ORA_WWV</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"standalone.access.log"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>/path/to/your/access.log</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"standalone.http.host"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>localhost</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"standalone.http.port"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>7001</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"standalone.context.path"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>/ords</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"standalone.static.path"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>/path/to/the/apex/images</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"standalone.static.context.path"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>/i/</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"misc.defaultPage"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>apex</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"jdbc.InitialLimit"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>10</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"jdbc.MaxLimit"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>20</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"jdbc.InactivityTimeout"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>60</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">properties</span><span class="z-punctuation z-definition z-tag">></span></span></code></pre><p>The two most important lines in relation to operation behind a reverse proxy:<pre class="giallo z-code"><code data-lang=xml><span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"security.externalSessionTrustedOrigins"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>localhost:8001</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span>
<span class=giallo-l><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">entry</span><span class="z-entity z-other z-attribute-name"> key</span><span class=z-text>=</span><span class="z-punctuation z-definition z-string z-string">"security.httpsHeaderCheck"</span><span class="z-punctuation z-definition z-tag">></span><span class=z-text>X-Forwarded-Proto:https</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">entry</span><span class="z-punctuation z-definition z-tag">></span></span></code></pre><p>The first line should actually help so that we don’t have to delete the Origin header in the direction of ORDS, but it didn’t work for me. The second line helps ORDS to recognize that the frontend server (reverse proxy) takes over the SSL termination. For a development server where both services run on localhost, I see no reason to secure the connection between the proxy and ORDS. That would go against my goal of using Caddy to benefit from a fully automated SSL solution. The situation is different for production environments, of course. Caddy can also secure the connection to ORDS.<h2 id=start-caddy>Start Caddy</h2><p>If you have everything together and your Caddyfile is in the same directory where you start Caddy, then the start command is particularly short:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">caddy</span><span class=z-string> run</span></span></code></pre><p>If the configuration file is somewhere else:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">caddy</span><span class=z-string> run --config /path/to/Caddyfile</span></span></code></pre><p>If you want to call the configuration file something else, but it is saved in Caddyfile format:<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">caddy</span><span class=z-string> run --config /path/to/config.txt --adapter caddyfile</span></span></code></pre><p>If you like, you can also register Caddy (and ORDS) as a service in your operating system so that you don’t have to start the servers manually.<p>I myself have built a small development server with Node.js, which first generates the configuration files for Caddy and ORDS, then installs ORDS in the PDB (if not already done), and then starts Caddy and ORDS each in a child process. I can then simply terminate both at the same time with Ctrl + C. In addition, a different port is automatically used for each development branch (hence the ports 7001 and 8001 in my examples here, in another branch this could also be 7005 and 8005), so that I can run several instances in parallel (this works well with Git worktrees). So I work very flexibly on the command line and start the required development server with a short command in the respective branch. But that would be a topic for another blog entry.<h2 id=conclusion>Conclusion</h2><p>I like it when everything looks good on the SSL side of my development environments. Caddy really is a great help in this respect. You could even use Caddy to provide an internal certification server, which then supplies all web servers within a network with certificates. I use this for remote development instances so that I only have to install a single root certificate for all machines. More about this in the <a class=external href=https://caddyserver.com/docs/caddyfile/directives/acme_server rel=external>official documentation</a>.<p>Maybe this blog post will help some of you out there in the wide world.<p>Have fun with the Caddy Server :-)<p>Ottmar</section><nav class="full-width article-navigation"><div><a aria-describedby=left_title aria-label=Prev href=https://ogobrecht.com/blog/generate-apex-plug-ins-on-the-command-line/><span class=arrow>←</span> Prev</a><p aria-hidden=true id=left_title>Generate APEX plug-ins on the command line</div><div></div></nav><div data-repo-id="MDEwOlJlcG9zaXRvcnkzMjEzNzI3MzE=" class=comments data-category=General data-category-id=DIC_kwDOEyfCO84C0uh1 data-dark-theme=noborder_dark data-input-position=bottom data-lang=en data-lazy-loading=true data-light-theme=noborder_light data-mapping=specific data-reactions-enabled=0 data-repo=ogobrecht/ogobrecht.com data-strict=1 data-term=caddy-server-and-apex-joel-kallman-day id=comments><script async src=https://ogobrecht.com/js/giscus.min.js></script><noscript>You need JavaScript to view the comments.</noscript></div></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/#introduction>Introduction</a><li><a href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/#installation>Installation</a><li><a href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/#caddy-configuration>Caddy Configuration</a><li><a href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/#ords-configuration>ORDS Configuration</a><li><a href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/#start-caddy>Start Caddy</a><li><a href=https://ogobrecht.com/blog/caddy-server-and-apex-joel-kallman-day/#conclusion>Conclusion</a></ul></div></div></div><a title="Go to the comments section" class=no-hover-padding href=#comments id=comments-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule=evenodd fill-rule=evenodd /></svg> </a><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://ogobrecht.com/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://ogobrecht.com/atom.xml> <img alt=feed loading=lazy src=https://ogobrecht.com/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/ogobrecht> <img alt=GitHub loading=lazy src=https://ogobrecht.com/social_icons/github.svg title=GitHub> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://bsky.app/profile/ogobrecht.com> <img alt=Bluesky loading=lazy src=https://ogobrecht.com/social_icons/bluesky.svg title=Bluesky> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://www.linkedin.com/in/ogobrecht/> <img alt=LinkedIn loading=lazy src=https://ogobrecht.com/social_icons/linkedin.svg title=LinkedIn> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=mailto:ottmar.gobrecht@gmail.com> <img alt=Email loading=lazy src=https://ogobrecht.com/social_icons/email.svg title=Email> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/imprint/> imprint </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/privacy/> privacy policy </a><li><a class="nav-links no-hover-padding" href=https://ogobrecht.com/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>